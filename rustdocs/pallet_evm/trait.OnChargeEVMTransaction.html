<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Handle withdrawing, refunding and depositing of transaction fees. Similar to `OnChargeTransaction` of `pallet_transaction_payment`"><meta name="keywords" content="rust, rustlang, rust-lang, OnChargeEVMTransaction"><title>OnChargeEVMTransaction in pallet_evm - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-3dd8914bdd6e2ce5.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../static.files/light-1469fca9efc07bcb.css"><link rel="stylesheet" disabled href="../static.files/dark-e9b7e5d8ba0dc980.css"><link rel="stylesheet" disabled href="../static.files/ayu-0c1cf144240c9f40.css"><script id="default-settings" ></script><script src="../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-799a64abec831f72.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../pallet_evm/index.html"><div class="logo-container"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../pallet_evm/index.html"><div class="logo-container"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2 class="location"><a href="#">OnChargeEVMTransaction</a></h2><div class="sidebar-elems"><section><h3><a href="#required-associated-types">Required Associated Types</a></h3><ul class="block"><li><a href="#associatedtype.LiquidityInfo">LiquidityInfo</a></li></ul><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.correct_and_deposit_fee">correct_and_deposit_fee</a></li><li><a href="#tymethod.pay_priority_fee">pay_priority_fee</a></li><li><a href="#tymethod.withdraw_fee">withdraw_fee</a></li></ul><h3><a href="#foreign-impls">Implementations on Foreign Types</a></h3><ul class="block"><li><a href="#impl-OnChargeEVMTransaction%3CT%3E-for-()">()</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In pallet_evm</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Trait <a href="index.html">pallet_evm</a>::<wbr><a class="trait" href="#">OnChargeEVMTransaction</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/pallet_evm/lib.rs.html#872-893">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><div class="item-decl"><pre class="rust trait"><code>pub trait OnChargeEVMTransaction&lt;T:&nbsp;<a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>&gt; {
    type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/default/trait.Default.html" title="trait core::default::Default">Default</a>;

    fn <a href="#tymethod.withdraw_fee" class="fnname">withdraw_fee</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;who: &amp;H160,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fee: U256<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>, <a class="enum" href="pallet/enum.Error.html" title="enum pallet_evm::pallet::Error">Error</a>&lt;T&gt;&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.correct_and_deposit_fee" class="fnname">correct_and_deposit_fee</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;who: &amp;H160,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;corrected_fee: U256,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_fee: U256,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;already_withdrawn: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.pay_priority_fee" class="fnname">pay_priority_fee</a>(tip: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>);
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Handle withdrawing, refunding and depositing of transaction fees.
Similar to <code>OnChargeTransaction</code> of <code>pallet_transaction_payment</code></p>
</div></details><h2 id="required-associated-types" class="small-section-header">Required Associated Types<a href="#required-associated-types" class="anchor"></a></h2><div class="methods"><section id="associatedtype.LiquidityInfo" class="method has-srclink"><a class="srclink rightside" href="../src/pallet_evm/lib.rs.html#873">source</a><h4 class="code-header">type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/default/trait.Default.html" title="trait core::default::Default">Default</a></h4></section></div><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.withdraw_fee" class="method has-srclink"><a class="srclink rightside" href="../src/pallet_evm/lib.rs.html#877">source</a><h4 class="code-header">fn <a href="#tymethod.withdraw_fee" class="fnname">withdraw_fee</a>(who: &amp;H160, fee: U256) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>, <a class="enum" href="pallet/enum.Error.html" title="enum pallet_evm::pallet::Error">Error</a>&lt;T&gt;&gt;</h4></section></summary><div class="docblock"><p>Before the transaction is executed the payment of the transaction fees
need to be secured.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.correct_and_deposit_fee" class="method has-srclink"><a class="srclink rightside" href="../src/pallet_evm/lib.rs.html#884-889">source</a><h4 class="code-header">fn <a href="#tymethod.correct_and_deposit_fee" class="fnname">correct_and_deposit_fee</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;who: &amp;H160,<br>&nbsp;&nbsp;&nbsp;&nbsp;corrected_fee: U256,<br>&nbsp;&nbsp;&nbsp;&nbsp;base_fee: U256,<br>&nbsp;&nbsp;&nbsp;&nbsp;already_withdrawn: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a><br>) -&gt; Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a></h4></section></summary><div class="docblock"><p>After the transaction was executed the actual fee can be calculated.
This function should refund any overpaid fees and optionally deposit
the corrected amount, and handles the base fee rationing using the provided
<code>OnUnbalanced</code> implementation.
Returns the <code>NegativeImbalance</code> - if any - produced by the priority fee.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.pay_priority_fee" class="method has-srclink"><a class="srclink rightside" href="../src/pallet_evm/lib.rs.html#892">source</a><h4 class="code-header">fn <a href="#tymethod.pay_priority_fee" class="fnname">pay_priority_fee</a>(tip: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>)</h4></section></summary><div class="docblock"><p>Introduced in EIP1559 to handle the priority tip.</p>
</div></details></div><h2 id="foreign-impls" class="small-section-header">Implementations on Foreign Types<a href="#foreign-impls" class="anchor"></a></h2><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-OnChargeEVMTransaction%3CT%3E-for-()" class="impl has-srclink"><a class="srclink rightside" href="../src/pallet_evm/lib.rs.html#995-1027">source</a><a href="#impl-OnChargeEVMTransaction%3CT%3E-for-()" class="anchor"></a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="trait.OnChargeEVMTransaction.html" title="trait pallet_evm::OnChargeEVMTransaction">OnChargeEVMTransaction</a>&lt;T&gt; for <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a><span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::PositiveImbalance: Imbalance&lt;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = &lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance: Imbalance&lt;&lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = &lt;T::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::PositiveImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;U256: UniqueSaturatedInto&lt;<a class="type" href="type.BalanceOf.html" title="type pallet_evm::BalanceOf">BalanceOf</a>&lt;T&gt;&gt;,</span></h3></section></summary><div class="docblock"><p>Implementation for () does not specify what to do with imbalance</p>
</div><div class="impl-items"><section id="associatedtype.LiquidityInfo-1" class="associatedtype trait-impl has-srclink"><a href="#associatedtype.LiquidityInfo-1" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&lt;&lt;T as <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>&gt;::<a class="associatedtype" href="pallet/trait.Config.html#associatedtype.Currency" title="type pallet_evm::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;</h4></section><section id="method.withdraw_fee" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/pallet_evm/lib.rs.html#1008-1013">source</a><a href="#method.withdraw_fee" class="anchor"></a><h4 class="code-header">fn <a href="#tymethod.withdraw_fee" class="fnname">withdraw_fee</a>(who: &amp;H160, fee: U256) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>, <a class="enum" href="pallet/enum.Error.html" title="enum pallet_evm::pallet::Error">Error</a>&lt;T&gt;&gt;</h4></section><section id="method.correct_and_deposit_fee" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/pallet_evm/lib.rs.html#1015-1022">source</a><a href="#method.correct_and_deposit_fee" class="anchor"></a><h4 class="code-header">fn <a href="#tymethod.correct_and_deposit_fee" class="fnname">correct_and_deposit_fee</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;who: &amp;H160,<br>&nbsp;&nbsp;&nbsp;&nbsp;corrected_fee: U256,<br>&nbsp;&nbsp;&nbsp;&nbsp;base_fee: U256,<br>&nbsp;&nbsp;&nbsp;&nbsp;already_withdrawn: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a><br>) -&gt; Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a></h4></section><section id="method.pay_priority_fee" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/pallet_evm/lib.rs.html#1024-1026">source</a><a href="#method.pay_priority_fee" class="anchor"></a><h4 class="code-header">fn <a href="#tymethod.pay_priority_fee" class="fnname">pay_priority_fee</a>(tip: Self::<a class="associatedtype" href="trait.OnChargeEVMTransaction.html#associatedtype.LiquidityInfo" title="type pallet_evm::OnChargeEVMTransaction::LiquidityInfo">LiquidityInfo</a>)</h4></section></div></details><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div id="implementors-list"><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-OnChargeEVMTransaction%3CT%3E-for-EVMCurrencyAdapter%3CC%2C%20OU%3E" class="impl has-srclink"><a class="srclink rightside" href="../src/pallet_evm/lib.rs.html#901-992">source</a><a href="#impl-OnChargeEVMTransaction%3CT%3E-for-EVMCurrencyAdapter%3CC%2C%20OU%3E" class="anchor"></a><h3 class="code-header">impl&lt;T, C, OU&gt; <a class="trait" href="trait.OnChargeEVMTransaction.html" title="trait pallet_evm::OnChargeEVMTransaction">OnChargeEVMTransaction</a>&lt;T&gt; for <a class="struct" href="struct.EVMCurrencyAdapter.html" title="struct pallet_evm::EVMCurrencyAdapter">EVMCurrencyAdapter</a>&lt;C, OU&gt;<span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="pallet/trait.Config.html" title="trait pallet_evm::pallet::Config">Config</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;C: Currency&lt;&lt;T as Config&gt;::AccountId&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;C::PositiveImbalance: Imbalance&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = C::NegativeImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;C::NegativeImbalance: Imbalance&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance, Opposite = C::PositiveImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;OU: OnUnbalanced&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;U256: UniqueSaturatedInto&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance&gt;,</span></h3></section></summary><div class="impl-items"><section id="associatedtype.LiquidityInfo-2" class="associatedtype trait-impl has-srclink"><a href="#associatedtype.LiquidityInfo-2" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.LiquidityInfo" class="associatedtype">LiquidityInfo</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&lt;C as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::NegativeImbalance&gt;</h4></section></div></details></div><script src="../implementors/pallet_evm/trait.OnChargeEVMTransaction.js" data-ignore-extern-crates="std" async></script></section></div></main><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="pallet_evm" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.0-nightly (a00f8ba7f 2022-11-15)" data-search-js="search-df80cc3cb87b6482.js" data-settings-js="settings-7873449fa8c00e11.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>