<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dynamic fee pallet | Frontier</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Ethereum compatibility layer for Substrate">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/frontier/assets/css/0.styles.63af2db7.css" as="style"><link rel="preload" href="/frontier/assets/js/app.922ce8c1.js" as="script"><link rel="preload" href="/frontier/assets/js/2.65699500.js" as="script"><link rel="preload" href="/frontier/assets/js/1.60f972cd.js" as="script"><link rel="preload" href="/frontier/assets/js/23.b812034e.js" as="script"><link rel="prefetch" href="/frontier/assets/js/10.8c8fc0ee.js"><link rel="prefetch" href="/frontier/assets/js/11.75a4c66a.js"><link rel="prefetch" href="/frontier/assets/js/12.d5d9dd87.js"><link rel="prefetch" href="/frontier/assets/js/13.a0987385.js"><link rel="prefetch" href="/frontier/assets/js/14.ff6659b8.js"><link rel="prefetch" href="/frontier/assets/js/15.5638655d.js"><link rel="prefetch" href="/frontier/assets/js/16.3dbd44d8.js"><link rel="prefetch" href="/frontier/assets/js/17.6c0fd7ec.js"><link rel="prefetch" href="/frontier/assets/js/18.2e68d933.js"><link rel="prefetch" href="/frontier/assets/js/19.7cda5482.js"><link rel="prefetch" href="/frontier/assets/js/20.567981c9.js"><link rel="prefetch" href="/frontier/assets/js/21.8ff64cfc.js"><link rel="prefetch" href="/frontier/assets/js/22.cad825e1.js"><link rel="prefetch" href="/frontier/assets/js/24.0fb2add8.js"><link rel="prefetch" href="/frontier/assets/js/25.5967ce54.js"><link rel="prefetch" href="/frontier/assets/js/26.dc8fa00a.js"><link rel="prefetch" href="/frontier/assets/js/27.f238707d.js"><link rel="prefetch" href="/frontier/assets/js/28.d8732020.js"><link rel="prefetch" href="/frontier/assets/js/3.7ce10896.js"><link rel="prefetch" href="/frontier/assets/js/4.0d310acb.js"><link rel="prefetch" href="/frontier/assets/js/5.012ba858.js"><link rel="prefetch" href="/frontier/assets/js/6.d86a6a22.js"><link rel="prefetch" href="/frontier/assets/js/7.ae7f0acf.js"><link rel="prefetch" href="/frontier/assets/js/vendors~docsearch.4849e3bc.js">
    <link rel="stylesheet" href="/frontier/assets/css/0.styles.63af2db7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/frontier/" class="home-link router-link-active"><!----> <span class="site-name">Frontier</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://paritytech.github.io/frontier/rustdocs/pallet_evm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API reference
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/paritytech/frontier" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://paritytech.github.io/frontier/rustdocs/pallet_evm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API reference
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/paritytech/frontier" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/frontier/overview.html" class="sidebar-link">Overview</a></li><li><a href="/frontier/frame/evm.html" class="sidebar-link">EVM pallet</a></li><li><a href="/frontier/frame/ethereum.html" class="sidebar-link">Ethereum pallet</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dynamic-fee-pallet"><a href="#dynamic-fee-pallet" class="header-anchor">#</a> Dynamic fee pallet</h1> <p>The dynamic fee pallet allows a Substrate blockchain with Frontier to simulate
the functionality of Ethereum dynamic fee adjustment.</p> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>The pallet works by keeping track of the current minimum gas price in a
Substrate storage <code>MinGasPrice</code>. Each Substrate block, the proposer can submit
an inherent extrinsic <code>note_min_gas_price_target</code>. When a block is built, the
minimum gas price is adjusted similar to Ethereum's algorithm.</p> <h2 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h2> <p>To use the dynamic fee pallet, first include the pallet in runtime by
implementing <code>pallet_dynamic_fee::Config</code>. The <code>MinGasPriceBoundDivisor</code> is a
divisor used to set how much the minimum gas price is adjusted each block. You
can set it to <code>1024</code> to get the same algorithm as Ethereum. After implementing
<code>pallet_dynamic_fee::Config</code>, include the pallet in the runtime definition.</p> <p>With the pallet in place, you can now extend the node to allow it to vote on the
minimum gas price target, via the inherent data providers. Locate in the node
service code where the <code>InherentDataProviders</code> struct is built, and add
<code>pallet_dynamic_fee</code>'s inherent data provider. The inherent data provider
requires a target gas price parameter to be provided. For that, you simply need
to add a new custom command line argument.</p> <p>An example code snippet is shown below:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">inherent_data_providers</span><span class="token punctuation">(</span>
    target_min_gas_price<span class="token punctuation">:</span> <span class="token constant">U256</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token namespace">sp_inherents<span class="token punctuation">::</span></span><span class="token class-name">InherentDataProviders</span><span class="token punctuation">,</span> <span class="token class-name">ServiceError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> inherent_data_providers <span class="token operator">=</span> <span class="token namespace">sp_inherents<span class="token punctuation">::</span></span><span class="token class-name">InherentDataProviders</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token operator">!</span>inherent_data_providers<span class="token punctuation">.</span><span class="token function">has_provider</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">pallet_dynamic_fee<span class="token punctuation">::</span></span><span class="token constant">INHERENT_IDENTIFIER</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        inherent_data_providers
            <span class="token punctuation">.</span><span class="token function">register_provider</span><span class="token punctuation">(</span><span class="token namespace">pallet_dynamic_fee<span class="token punctuation">::</span></span><span class="token class-name">InherentDataProvider</span><span class="token punctuation">(</span>target_min_gas_price<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map_err</span><span class="token punctuation">(</span><span class="token class-name">Into</span><span class="token punctuation">::</span>into<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map_err</span><span class="token punctuation">(</span><span class="token namespace">sp_consensus<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token punctuation">::</span><span class="token class-name">InherentData</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span>inherent_data_providers<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/frontier/assets/js/app.922ce8c1.js" defer></script><script src="/frontier/assets/js/2.65699500.js" defer></script><script src="/frontier/assets/js/1.60f972cd.js" defer></script><script src="/frontier/assets/js/23.b812034e.js" defer></script>
  </body>
</html>
