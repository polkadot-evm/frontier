use crate::mock::*;
use frame_support::{assert_noop, assert_ok};
use hex::FromHex;
use pallet_evm::{ExitReason, ExitSucceed};
use sp_core::{H160, H256};
use std::str::FromStr;

#[test]
fn set_authority_works() {
	new_test_ext().execute_with(|| {
		let authority = H160::from_str(AUTHORITY_ADDR).unwrap();
		assert_ok!(EvmTxReplay::set_authority(RuntimeOrigin::root(), authority));
		assert_eq!(EvmTxReplay::authority(), Some(authority));
	});
}

#[test]
fn tx_replay_works() {
	new_test_ext().execute_with(|| {
		let authority = H160::from_str(AUTHORITY_ADDR).unwrap();
		assert_ok!(EvmTxReplay::set_authority(RuntimeOrigin::root(), authority));

		let from = H160::from_str(EVM_SENDER_ADDR).unwrap();
		let nonce = 0;
		let gas_price = 1000;
		let gas_limit = 7800000;
		let value = 0;
		// no 0x prefix!
		let data = Vec::from_hex
			("6101406040523480156200001257600080fd5b506040516200404b3803806200404b833981810160405281019062000038919062000605565b6040518060400160405280600881526020017f4d7974686963616c0000000000000000000000000000000000000000000000008152506040518060400160405280600181526020017f3100000000000000000000000000000000000000000000000000000000000000815250818160008280519060200120905060008280519060200120905060007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f90508260e081815250508161010081815250504660a081815250506200010f8184846200029e60201b60201c565b608081815250503073ffffffffffffffffffffffffffffffffffffffff1660c08173ffffffffffffffffffffffffffffffffffffffff16815250508061012081815250505050505050620001ae604051806080016040528084815260200183815260200162000183620002da60201b60201c565b81526020013073ffffffffffffffffffffffffffffffffffffffff16815250620002e260201b60201c565b6000819055505050620001d6620001ca6200035a60201b60201c565b6200036260201b60201c565b6000600360006101000a81548160ff021916908315150217905550620002156000801b620002096200035a60201b60201c565b6200042860201b60201c565b620002567f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad6200024a6200035a60201b60201c565b6200042860201b60201c565b80600360016101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050620006db565b60008383834630604051602001620002bb9594939291906200067e565b6040516020818303038152906040528051906020012090509392505050565b600046905090565b60007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f826000015180519060200120836020015180519060200120846040015185606001516040516020016200033d9594939291906200067e565b604051602081830303815290604052805190602001209050919050565b600033905090565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b6200043a82826200043e60201b60201c565b5050565b6200045082826200053060201b60201c565b6200052c5760016002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff021916908315150217905550620004d16200035a60201b60201c565b73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16837f2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d60405160405180910390a45b5050565b60006002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000620005cd82620005a0565b9050919050565b620005df81620005c0565b8114620005eb57600080fd5b50565b600081519050620005ff81620005d4565b92915050565b6000602082840312156200061e576200061d6200059b565b5b60006200062e84828501620005ee565b91505092915050565b6000819050919050565b6200064c8162000637565b82525050565b6000819050919050565b620006678162000652565b82525050565b6200067881620005c0565b82525050565b600060a08201905062000695600083018862000641565b620006a4602083018762000641565b620006b3604083018662000641565b620006c260608301856200065c565b620006d160808301846200066d565b9695505050505050565b60805160a05160c05160e0516101005161012051613932620007196000396000505060005050600050506000505060005050600050506139326000f3fe6080604052600436106101bb5760003560e01c806391d14854116100ec578063d4ad5e151161008a578063e657eea511610064578063e657eea5146105eb578063f2dd0bb714610607578063f2fde38b14610644578063f831d97c1461066d576101c2565b8063d4ad5e1514610548578063d547741f14610585578063e58497c0146105ae576101c2565b8063a217fddf116100c6578063a217fddf146104a2578063ac8a584a146104cd578063ae38e265146104f6578063cc04ba6e1461051f576101c2565b806391d14854146103ff5780639870d7fe1461043c5780639b08a3a514610465576101c2565b80633f4ba83a116101595780636c1d4edd116101335780636c1d4edd1461037d578063715018a6146103a65780638456cb59146103bd5780638da5cb5b146103d4576101c2565b80633f4ba83a1461031257806356ce180a146103295780635c975abb14610352576101c2565b80632f2ff15d116101955780632f2ff15d1461026c5780633408e4701461029557806336568abe146102c05780633ebc1374146102e9576101c2565b806301ffc9a7146101c757806319c07fed14610204578063248a9ca31461022f576101c2565b366101c257005b600080fd5b3480156101d357600080fd5b506101ee60048036038101906101e991906120f6565b6106aa565b6040516101fb919061213e565b60405180910390f35b34801561021057600080fd5b50610219610724565b6040516102269190612172565b60405180910390f35b34801561023b57600080fd5b50610256600480360381019061025191906121b9565b610748565b6040516102639190612172565b60405180910390f35b34801561027857600080fd5b50610293600480360381019061028e9190612244565b610768565b005b3480156102a157600080fd5b506102aa610789565b6040516102b7919061229d565b60405180910390f35b3480156102cc57600080fd5b506102e760048036038101906102e29190612244565b610791565b005b3480156102f557600080fd5b50610310600480360381019061030b91906122e4565b610814565b005b34801561031e57600080fd5b50610327610939565b005b34801561033557600080fd5b50610350600480360381019061034b9190612337565b61094b565b005b34801561035e57600080fd5b50610367610a06565b604051610374919061213e565b60405180910390f35b34801561038957600080fd5b506103a4600480360381019061039f9190612443565b610a1d565b005b3480156103b257600080fd5b506103bb610cd7565b005b3480156103c957600080fd5b506103d2610ceb565b005b3480156103e057600080fd5b506103e9610cfd565b6040516103f691906124da565b60405180910390f35b34801561040b57600080fd5b5061042660048036038101906104219190612244565b610d27565b604051610433919061213e565b60405180910390f35b34801561044857600080fd5b50610463600480360381019061045e9190612337565b610d92565b005b34801561047157600080fd5b5061048c60048036038101906104879190612337565b610e6d565b604051610499919061213e565b60405180910390f35b3480156104ae57600080fd5b506104b7610e8d565b6040516104c49190612172565b60405180910390f35b3480156104d957600080fd5b506104f460048036038101906104ef9190612337565b610e94565b005b34801561050257600080fd5b5061051d600480360381019061051891906124f5565b610f69565b005b34801561052b57600080fd5b5061054660048036038101906105419190612689565b61110c565b005b34801561055457600080fd5b5061056f600480360381019061056a91906121b9565b61125a565b60405161057c919061213e565b60405180910390f35b34801561059157600080fd5b506105ac60048036038101906105a79190612244565b61127a565b005b3480156105ba57600080fd5b506105d560048036038101906105d091906126e5565b61129b565b6040516105e29190612721565b60405180910390f35b6106056004803603810190610600919061273c565b6112c2565b005b34801561061357600080fd5b5061062e600480360381019061062991906121b9565b611682565b60405161063b91906124da565b60405180910390f35b34801561065057600080fd5b5061066b60048036038101906106669190612337565b6116b5565b005b34801561067957600080fd5b50610694600480360381019061068f9190612836565b611738565b6040516106a191906124da565b60405180910390f35b60007f7965db0b000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061071d575061071c82611785565b5b9050919050565b7f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad81565b600060026000838152602001908152602001600020600101549050919050565b61077182610748565b61077a816117ef565b6107848383611803565b505050565b600046905090565b6107996118e4565b73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614610806576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016107fd90612928565b60405180910390fd5b61081082826118ec565b5050565b61081c6119ce565b6004600084815260200190815260200160002060009054906101000a900460ff1661087c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161087390612994565b60405180910390fd5b60006006600085815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060008173ffffffffffffffffffffffffffffffffffffffff16630a6d55d8866040518263ffffffff1660e01b81526004016108ef9190612172565b602060405180830381865afa15801561090c573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061093091906129c9565b90505050505050565b6109416119ce565b610949611a4c565b565b6109536119ce565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036109c2576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016109b990612a42565b60405180910390fd5b80600360016101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b6000600360009054906101000a900460ff16905090565b610a477f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad33610d27565b610a86576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a7d90612aae565b60405180910390fd5b610a8e611aaf565b60006006600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060008661ffff1660108767ffffffffffffffff1668ffffffffffffffffff16901b1790506000828686604051602001610b0193929190612b46565b6040516020818303038152906040528051906020012090506000600860008468ffffffffffffffffff1668ffffffffffffffffff1681526020019081526020016000206000838152602001908152602001600020905060036004811115610b6b57610b6a612b70565b5b8160000160009054906101000a900460ff166004811115610b8f57610b8e612b70565b5b03610bcf576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610bc690612c11565b60405180910390fd5b60038160000160006101000a81548160ff02191690836004811115610bf757610bf6612b70565b5b021790555060008490508073ffffffffffffffffffffffffffffffffffffffff166331ed8ea9878a8a6040518463ffffffff1660e01b8152600401610c3e93929190612c6f565b600060405180830381600087803b158015610c5857600080fd5b505af1158015610c6c573d6000803e3d6000fd5b5050505060036004811115610c8457610c83612b70565b5b8967ffffffffffffffff168b61ffff167f30d60fb848be3b1ac6f234f975cc4511adaced9169b02dfabc4dbeaddf475f7d86604051610cc39190612172565b60405180910390a450505050505050505050565b610cdf6119ce565b610ce96000611af9565b565b610cf36119ce565b610cfb611bbf565b565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60006002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b610d9a6119ce565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610e09576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e0090612d13565b60405180910390fd5b610e337f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad82610768565b7fac6fa858e9350a46cec16539926e0fde25b7629f84b5a72bffaae4df888ae86d81604051610e6291906124da565b60405180910390a150565b60076020528060005260406000206000915054906101000a900460ff1681565b6000801b81565b610e9c6119ce565b610ec67f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad82610d27565b610f05576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610efc90612da5565b60405180910390fd5b610f2f7f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad8261127a565b7f80c0b871b97b595b16a7741c1b06fed0c6f6f558639f18ccbce50724325dc40d81604051610f5e91906124da565b60405180910390a150565b610f937f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad33610d27565b610fd2576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610fc990612aae565b60405180910390fd5b60016004600085815260200190815260200160002060006101000a81548160ff021916908315150217905550816006600085815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008290508073ffffffffffffffffffffffffffffffffffffffff1663b8fa373685846040518363ffffffff1660e01b8152600401611090929190612dc5565b600060405180830381600087803b1580156110aa57600080fd5b505af11580156110be573d6000803e3d6000fd5b50505050838273ffffffffffffffffffffffffffffffffffffffff167fe6b5957a9e181d651f1ac05357cc4153c85f952095f5a4da19ab94958b55a5e960405160405180910390a350505050565b6111367f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad33610d27565b611175576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161116c90612aae565b60405180910390fd5b60006006600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060008190508073ffffffffffffffffffffffffffffffffffffffff16630968f264856040518263ffffffff1660e01b81526004016111eb9190612e65565b600060405180830381600087803b15801561120557600080fd5b505af1158015611219573d6000803e3d6000fd5b505050507ff67611512e0a2d90c96fd3f08dca4971bc45fba9dc679eabe839a32abbe58a8e3360405161124c91906124da565b60405180910390a150505050565b60046020528060005260406000206000915054906101000a900460ff1681565b61128382610748565b61128c816117ef565b61129683836118ec565b505050565b60056020528060005260406000206000915054906101000a900467ffffffffffffffff1681565b6112ca611aaf565b6004600086815260200190815260200160002060009054906101000a900460ff1661132a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161132190612ef9565b60405180910390fd5b85421061136c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161136390612f65565b60405180910390fd5b8634146113ae576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016113a590612fd1565b60405180910390fd5b600360019054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166113f2888887611738565b73ffffffffffffffffffffffffffffffffffffffff1614611448576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161143f90613063565b60405180910390fd5b6000600560008a61ffff1661ffff168152602001908152602001600020600081819054906101000a900467ffffffffffffffff16611485906130b2565b91906101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790559050600073ffffffffffffffffffffffffffffffffffffffff166006600088815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff160361154e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161154590613154565b60405180910390fd5b60006006600088815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060008173ffffffffffffffffffffffffffffffffffffffff16636186e1c4898d868d6115b06118e4565b8c8c8c6040518963ffffffff1660e01b81526004016115d6989796959493929190613183565b6000604051808303816000875af11580156115f5573d6000803e3d6000fd5b505050506040513d6000823e3d601f19601f8201168201806040525081019061161e9190613272565b90508267ffffffffffffffff16888c61ffff167f85ebdc976584c0d4798841a76925cdd5c9e6238521195a96255f6715eee978ab61165a6118e4565b89898760405161166d94939291906132bb565b60405180910390a45050505050505050505050565b60066020528060005260406000206000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6116bd6119ce565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff160361172c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161172390613374565b60405180910390fd5b61173581611af9565b50565b6000806040518060400160405280868152602001858152509050600080600061176086611c22565b80935081945082955050505061177884848484611c65565b9450505050509392505050565b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b611800816117fb6118e4565b611cf7565b50565b61180d8282610d27565b6118e05760016002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506118856118e4565b73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16837f2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d60405160405180910390a45b5050565b600033905090565b6118f68282610d27565b156119ca5760006002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555061196f6118e4565b73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16837ff6391f5c32d9c69d2a47ea670b442974b53935d1edc7fd64eb21e047a839171b60405160405180910390a45b5050565b6119d66118e4565b73ffffffffffffffffffffffffffffffffffffffff166119f4610cfd565b73ffffffffffffffffffffffffffffffffffffffff1614611a4a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611a41906133e0565b60405180910390fd5b565b611a54611d7c565b6000600360006101000a81548160ff0219169083151502179055507f5db9ee0a495bf2e6ff9c91a7834c1ba4fdd244a5e8aa4e537bd38aeae4b073aa611a986118e4565b604051611aa591906124da565b60405180910390a1565b611ab7610a06565b15611af7576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611aee9061344c565b60405180910390fd5b565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b611bc7611aaf565b6001600360006101000a81548160ff0219169083151502179055507f62e78cea01bee320cd4e420270b5ea74000d11b0c9f74754ebdbfc544b05a258611c0b6118e4565b604051611c1891906124da565b60405180910390a1565b60008060006041845114611c3557600080fd5b60008060006020870151925060408701519150606087015160001a90508083839550955095505050509193909250565b600080600054611c7487611dc5565b604051602001611c859291906134e4565b60405160208183030381529060405280519060200120905060018186868660405160008152602001604052604051611cc09493929190613537565b6020604051602081039080840390855afa158015611ce2573d6000803e3d6000fd5b50505060206040510351915050949350505050565b611d018282610d27565b611d7857611d0e81611e21565b611d1c8360001c6020611e4e565b604051602001611d2d929190613650565b6040516020818303038152906040526040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611d6f91906136c3565b60405180910390fd5b5050565b611d84610a06565b611dc3576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611dba90613731565b60405180910390fd5b565b60007f2e66d0f9c756c5a709dfbfe011049def740fec7ae112683cd453e5b7300e85bb82600001518360200151604051602001611e0493929190613751565b604051602081830303815290604052805190602001209050919050565b6060611e478273ffffffffffffffffffffffffffffffffffffffff16601460ff16611e4e565b9050919050565b606060006002836002611e619190613788565b611e6b91906137e2565b67ffffffffffffffff811115611e8457611e8361255e565b5b6040519080825280601f01601f191660200182016040528015611eb65781602001600182028036833780820191505090505b5090507f300000000000000000000000000000000000000000000000000000000000000081600081518110611eee57611eed613838565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053507f780000000000000000000000000000000000000000000000000000000000000081600181518110611f5257611f51613838565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535060006001846002611f929190613788565b611f9c91906137e2565b90505b600181111561203c577f3031323334353637383961626364656600000000000000000000000000000000600f861660108110611fde57611fdd613838565b5b1a60f81b828281518110611ff557611ff4613838565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350600485901c94508061203590613867565b9050611f9f565b5060008414612080576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612077906138dc565b60405180910390fd5b8091505092915050565b6000604051905090565b600080fd5b600080fd5b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b6120d38161209e565b81146120de57600080fd5b50565b6000813590506120f0816120ca565b92915050565b60006020828403121561210c5761210b612094565b5b600061211a848285016120e1565b91505092915050565b60008115159050919050565b61213881612123565b82525050565b6000602082019050612153600083018461212f565b92915050565b6000819050919050565b61216c81612159565b82525050565b60006020820190506121876000830184612163565b92915050565b61219681612159565b81146121a157600080fd5b50565b6000813590506121b38161218d565b92915050565b6000602082840312156121cf576121ce612094565b5b60006121dd848285016121a4565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000612211826121e6565b9050919050565b61222181612206565b811461222c57600080fd5b50565b60008135905061223e81612218565b92915050565b6000806040838503121561225b5761225a612094565b5b6000612269858286016121a4565b925050602061227a8582860161222f565b9150509250929050565b6000819050919050565b61229781612284565b82525050565b60006020820190506122b2600083018461228e565b92915050565b6122c181612284565b81146122cc57600080fd5b50565b6000813590506122de816122b8565b92915050565b6000806000606084860312156122fd576122fc612094565b5b600061230b868287016121a4565b935050602061231c868287016122cf565b925050604061232d8682870161222f565b9150509250925092565b60006020828403121561234d5761234c612094565b5b600061235b8482850161222f565b91505092915050565b600061ffff82169050919050565b61237b81612364565b811461238657600080fd5b50565b60008135905061239881612372565b92915050565b600067ffffffffffffffff82169050919050565b6123bb8161239e565b81146123c657600080fd5b50565b6000813590506123d8816123b2565b92915050565b600080fd5b600080fd5b600080fd5b60008083601f840112612403576124026123de565b5b8235905067ffffffffffffffff8111156124205761241f6123e3565b5b60208301915083600182028301111561243c5761243b6123e8565b5b9250929050565b60008060008060006080868803121561245f5761245e612094565b5b600061246d88828901612389565b955050602061247e888289016123c9565b945050604086013567ffffffffffffffff81111561249f5761249e612099565b5b6124ab888289016123ed565b935093505060606124be888289016121a4565b9150509295509295909350565b6124d481612206565b82525050565b60006020820190506124ef60008301846124cb565b92915050565b60008060006060848603121561250e5761250d612094565b5b600061251c868287016121a4565b935050602061252d8682870161222f565b925050604061253e8682870161222f565b9150509250925092565b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6125968261254d565b810181811067ffffffffffffffff821117156125b5576125b461255e565b5b80604052505050565b60006125c861208a565b90506125d4828261258d565b919050565b600067ffffffffffffffff8211156125f4576125f361255e565b5b6125fd8261254d565b9050602081019050919050565b82818337600083830152505050565b600061262c612627846125d9565b6125be565b90508281526020810184848401111561264857612647612548565b5b61265384828561260a565b509392505050565b600082601f8301126126705761266f6123de565b5b8135612680848260208601612619565b91505092915050565b600080604083850312156126a05761269f612094565b5b600083013567ffffffffffffffff8111156126be576126bd612099565b5b6126ca8582860161265b565b92505060206126db858286016121a4565b9150509250929050565b6000602082840312156126fb576126fa612094565b5b600061270984828501612389565b91505092915050565b61271b8161239e565b82525050565b60006020820190506127366000830184612712565b92915050565b60008060008060008060008060e0898b03121561275c5761275b612094565b5b600061276a8b828c016122cf565b985050602061277b8b828c016122cf565b975050604061278c8b828c016122cf565b965050606061279d8b828c016121a4565b955050608089013567ffffffffffffffff8111156127be576127bd612099565b5b6127ca8b828c0161265b565b94505060a089013567ffffffffffffffff8111156127eb576127ea612099565b5b6127f78b828c0161265b565b93505060c089013567ffffffffffffffff81111561281857612817612099565b5b6128248b828c016123ed565b92509250509295985092959890939650565b60008060006060848603121561284f5761284e612094565b5b600061285d868287016122cf565b935050602061286e868287016122cf565b925050604084013567ffffffffffffffff81111561288f5761288e612099565b5b61289b8682870161265b565b9150509250925092565b600082825260208201905092915050565b7f416363657373436f6e74726f6c3a2063616e206f6e6c792072656e6f756e636560008201527f20726f6c657320666f722073656c660000000000000000000000000000000000602082015250565b6000612912602f836128a5565b915061291d826128b6565b604082019050919050565b6000602082019050818103600083015261294181612905565b9050919050565b7f7265736f75726365206e6f742072656769737465726564000000000000000000600082015250565b600061297e6017836128a5565b915061298982612948565b602082019050919050565b600060208201905081810360008301526129ad81612971565b9050919050565b6000815190506129c381612218565b92915050565b6000602082840312156129df576129de612094565b5b60006129ed848285016129b4565b91505092915050565b7f496e76616c69642051756f7465205369676e6572000000000000000000000000600082015250565b6000612a2c6014836128a5565b9150612a37826129f6565b602082019050919050565b60006020820190508181036000830152612a5b81612a1f565b9050919050565b7f425249444745203a20556e617574686f72697a65640000000000000000000000600082015250565b6000612a986015836128a5565b9150612aa382612a62565b602082019050919050565b60006020820190508181036000830152612ac781612a8b565b9050919050565b60008160601b9050919050565b6000612ae682612ace565b9050919050565b6000612af882612adb565b9050919050565b612b10612b0b82612206565b612aed565b82525050565b600081905092915050565b6000612b2d8385612b16565b9350612b3a83858461260a565b82840190509392505050565b6000612b528286612aff565b601482019150612b63828486612b21565b9150819050949350505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b7f425249444745203a2065786563757465427269646765203a20616c726561647960008201527f206465706f736974656400000000000000000000000000000000000000000000602082015250565b6000612bfb602a836128a5565b9150612c0682612b9f565b604082019050919050565b60006020820190508181036000830152612c2a81612bee565b9050919050565b600082825260208201905092915050565b6000612c4e8385612c31565b9350612c5b83858461260a565b612c648361254d565b840190509392505050565b6000604082019050612c846000830186612163565b8181036020830152612c97818486612c42565b9050949350505050565b7f425249444745203a2061646452656c6179203a206e6f2061646472657373207060008201527f726f766964656400000000000000000000000000000000000000000000000000602082015250565b6000612cfd6027836128a5565b9150612d0882612ca1565b604082019050919050565b60006020820190508181036000830152612d2c81612cf0565b9050919050565b7f425249444745203a2072656d6f766552656c6179203a206e6f7420612072656c60008201527f6179000000000000000000000000000000000000000000000000000000000000602082015250565b6000612d8f6022836128a5565b9150612d9a82612d33565b604082019050919050565b60006020820190508181036000830152612dbe81612d82565b9050919050565b6000604082019050612dda6000830185612163565b612de760208301846124cb565b9392505050565b600081519050919050565b60005b83811015612e17578082015181840152602081019050612dfc565b83811115612e26576000848401525b50505050565b6000612e3782612dee565b612e418185612c31565b9350612e51818560208601612df9565b612e5a8161254d565b840191505092915050565b60006020820190508181036000830152612e7f8184612e2c565b905092915050565b7f425249444745203a206465706f736974203a20696e76616c6964207265736f7560008201527f7263650000000000000000000000000000000000000000000000000000000000602082015250565b6000612ee36023836128a5565b9150612eee82612e87565b604082019050919050565b60006020820190508181036000830152612f1281612ed6565b9050919050565b7f425249444745203a206465706f736974203a207061737320646561646c696e65600082015250565b6000612f4f6020836128a5565b9150612f5a82612f19565b602082019050919050565b60006020820190508181036000830152612f7e81612f42565b9050919050565b7f425249444745203a206465706f736974203a20696e76616c696420636f737400600082015250565b6000612fbb601f836128a5565b9150612fc682612f85565b602082019050919050565b60006020820190508181036000830152612fea81612fae565b9050919050565b7f425249444745203a206465706f736974203a20696e76616c69642051756f746560008201527f205369676e657200000000000000000000000000000000000000000000000000602082015250565b600061304d6027836128a5565b915061305882612ff1565b604082019050919050565b6000602082019050818103600083015261307c81613040565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006130bd8261239e565b915067ffffffffffffffff82036130d7576130d6613083565b5b600182019050919050565b7f425249444745203a206465706f736974203a20696e76616c6964207265736f7560008201527f7263652069640000000000000000000000000000000000000000000000000000602082015250565b600061313e6026836128a5565b9150613149826130e2565b604082019050919050565b6000602082019050818103600083015261316d81613131565b9050919050565b61317d81612364565b82525050565b600060e082019050613198600083018b612163565b6131a5602083018a613174565b6131b26040830189612712565b6131bf606083018861228e565b6131cc60808301876124cb565b81810360a08301526131de8186612e2c565b905081810360c08301526131f3818486612c42565b90509998505050505050505050565b6000613215613210846125d9565b6125be565b90508281526020810184848401111561323157613230612548565b5b61323c848285612df9565b509392505050565b600082601f830112613259576132586123de565b5b8151613269848260208601613202565b91505092915050565b60006020828403121561328857613287612094565b5b600082015167ffffffffffffffff8111156132a6576132a5612099565b5b6132b284828501613244565b91505092915050565b60006060820190506132d060008301876124cb565b81810360208301526132e3818587612c42565b905081810360408301526132f78184612e2c565b905095945050505050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160008201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b600061335e6026836128a5565b915061336982613302565b604082019050919050565b6000602082019050818103600083015261338d81613351565b9050919050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572600082015250565b60006133ca6020836128a5565b91506133d582613394565b602082019050919050565b600060208201905081810360008301526133f9816133bd565b9050919050565b7f5061757361626c653a2070617573656400000000000000000000000000000000600082015250565b60006134366010836128a5565b915061344182613400565b602082019050919050565b6000602082019050818103600083015261346581613429565b9050919050565b600081905092915050565b7f1901000000000000000000000000000000000000000000000000000000000000600082015250565b60006134ad60028361346c565b91506134b882613477565b600282019050919050565b6000819050919050565b6134de6134d982612159565b6134c3565b82525050565b60006134ef826134a0565b91506134fb82856134cd565b60208201915061350b82846134cd565b6020820191508190509392505050565b600060ff82169050919050565b6135318161351b565b82525050565b600060808201905061354c6000830187612163565b6135596020830186613528565b6135666040830185612163565b6135736060830184612163565b95945050505050565b7f416363657373436f6e74726f6c3a206163636f756e7420000000000000000000600082015250565b60006135b260178361346c565b91506135bd8261357c565b601782019050919050565b600081519050919050565b60006135de826135c8565b6135e8818561346c565b93506135f8818560208601612df9565b80840191505092915050565b7f206973206d697373696e6720726f6c6520000000000000000000000000000000600082015250565b600061363a60118361346c565b915061364582613604565b601182019050919050565b600061365b826135a5565b915061366782856135d3565b91506136728261362d565b915061367e82846135d3565b91508190509392505050565b6000613695826135c8565b61369f81856128a5565b93506136af818560208601612df9565b6136b88161254d565b840191505092915050565b600060208201905081810360008301526136dd818461368a565b905092915050565b7f5061757361626c653a206e6f7420706175736564000000000000000000000000600082015250565b600061371b6014836128a5565b9150613726826136e5565b602082019050919050565b6000602082019050818103600083015261374a8161370e565b9050919050565b60006060820190506137666000830186612163565b613773602083018561228e565b613780604083018461228e565b949350505050565b600061379382612284565b915061379e83612284565b9250817fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff04831182151516156137d7576137d6613083565b5b828202905092915050565b60006137ed82612284565b91506137f883612284565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0382111561382d5761382c613083565b5b828201905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b600061387282612284565b91506000820361388557613884613083565b5b600182039050919050565b7f537472696e67733a20686578206c656e67746820696e73756666696369656e74600082015250565b60006138c66020836128a5565b91506138d182613890565b602082019050919050565b600060208201905081810360008301526138f5816138b9565b905091905056fea2646970667358221220d33f30ebba1e6e1455b3ef004c389c602cfc7dcc1985274a7211ff529a5470ce64736f6c634300080f00330000000000000000000000005e2157a078d15821dafb0d53aa8b08cbd31bdd65").unwrap();
		let v = 403643;
		let r = H256::from_str
			("0x984c457a98af24965852aabf4b18ac93dc475edfb85a3c65d36ec21755a552bf").unwrap();
		let s = H256::from_str
			("0x1997ddc6db499f3dfe59d1df9a82cef6f5accb9088120aa6253ef13894aef287").unwrap();
		assert_ok!(EvmTxReplay::replay_tx(
			RuntimeOrigin::signed(authority),
			0,
			from,
			nonce.into(),
			gas_price.into(),
			gas_limit.into(),
			None,
			value.into(),
			data,
			v,
			r,
			s)
		);

		// System::assert_last_event(
		// 	RuntimeEvent::EvmTxReplay(crate::Event::TransactionReplayed(0)),
		// );

		let expected_contract_address = H160::from_str("a18D092eeCC276514B573cB4Fe86620Cc7A62A16").unwrap();
		let empty_vec: Vec<u8> = Vec::new();

		assert_ne!(pallet_evm::AccountCodes::<Test>::get(expected_contract_address), empty_vec);

		let expected_tx_hash = H256::from_str("0x4e99e28c2d873dc57333d13d792fc15939b6942f1cfeb56963dca042d0dd95ec").unwrap();

		System::assert_has_event(RuntimeEvent::Ethereum(pallet_ethereum::Event::Executed {
			from,
			to: expected_contract_address,
			transaction_hash: expected_tx_hash,
			exit_reason: ExitReason::Succeed(ExitSucceed::Returned),
			extra_data: vec![],
		}));
	});
}

#[test]
fn tx_replay_wrong_authority_fails() {
	new_test_ext().execute_with(|| {
		let authority = H160::from_str(AUTHORITY_ADDR).unwrap();
		assert_ok!(EvmTxReplay::set_authority(RuntimeOrigin::root(), authority));

		let from = H160::from_str(EVM_SENDER_ADDR).unwrap();
		let nonce = 0;
		let gas_price = 1000;
		let gas_limit = 7800000;
		let value = 0;
		// no 0x prefix!
		let data = Vec::from_hex
			("6101406040523480156200001257600080fd5b506040516200404b3803806200404b833981810160405281019062000038919062000605565b6040518060400160405280600881526020017f4d7974686963616c0000000000000000000000000000000000000000000000008152506040518060400160405280600181526020017f3100000000000000000000000000000000000000000000000000000000000000815250818160008280519060200120905060008280519060200120905060007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f90508260e081815250508161010081815250504660a081815250506200010f8184846200029e60201b60201c565b608081815250503073ffffffffffffffffffffffffffffffffffffffff1660c08173ffffffffffffffffffffffffffffffffffffffff16815250508061012081815250505050505050620001ae604051806080016040528084815260200183815260200162000183620002da60201b60201c565b81526020013073ffffffffffffffffffffffffffffffffffffffff16815250620002e260201b60201c565b6000819055505050620001d6620001ca6200035a60201b60201c565b6200036260201b60201c565b6000600360006101000a81548160ff021916908315150217905550620002156000801b620002096200035a60201b60201c565b6200042860201b60201c565b620002567f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad6200024a6200035a60201b60201c565b6200042860201b60201c565b80600360016101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050620006db565b60008383834630604051602001620002bb9594939291906200067e565b6040516020818303038152906040528051906020012090509392505050565b600046905090565b60007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f826000015180519060200120836020015180519060200120846040015185606001516040516020016200033d9594939291906200067e565b604051602081830303815290604052805190602001209050919050565b600033905090565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b6200043a82826200043e60201b60201c565b5050565b6200045082826200053060201b60201c565b6200052c5760016002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff021916908315150217905550620004d16200035a60201b60201c565b73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16837f2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d60405160405180910390a45b5050565b60006002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000620005cd82620005a0565b9050919050565b620005df81620005c0565b8114620005eb57600080fd5b50565b600081519050620005ff81620005d4565b92915050565b6000602082840312156200061e576200061d6200059b565b5b60006200062e84828501620005ee565b91505092915050565b6000819050919050565b6200064c8162000637565b82525050565b6000819050919050565b620006678162000652565b82525050565b6200067881620005c0565b82525050565b600060a08201905062000695600083018862000641565b620006a4602083018762000641565b620006b3604083018662000641565b620006c260608301856200065c565b620006d160808301846200066d565b9695505050505050565b60805160a05160c05160e0516101005161012051613932620007196000396000505060005050600050506000505060005050600050506139326000f3fe6080604052600436106101bb5760003560e01c806391d14854116100ec578063d4ad5e151161008a578063e657eea511610064578063e657eea5146105eb578063f2dd0bb714610607578063f2fde38b14610644578063f831d97c1461066d576101c2565b8063d4ad5e1514610548578063d547741f14610585578063e58497c0146105ae576101c2565b8063a217fddf116100c6578063a217fddf146104a2578063ac8a584a146104cd578063ae38e265146104f6578063cc04ba6e1461051f576101c2565b806391d14854146103ff5780639870d7fe1461043c5780639b08a3a514610465576101c2565b80633f4ba83a116101595780636c1d4edd116101335780636c1d4edd1461037d578063715018a6146103a65780638456cb59146103bd5780638da5cb5b146103d4576101c2565b80633f4ba83a1461031257806356ce180a146103295780635c975abb14610352576101c2565b80632f2ff15d116101955780632f2ff15d1461026c5780633408e4701461029557806336568abe146102c05780633ebc1374146102e9576101c2565b806301ffc9a7146101c757806319c07fed14610204578063248a9ca31461022f576101c2565b366101c257005b600080fd5b3480156101d357600080fd5b506101ee60048036038101906101e991906120f6565b6106aa565b6040516101fb919061213e565b60405180910390f35b34801561021057600080fd5b50610219610724565b6040516102269190612172565b60405180910390f35b34801561023b57600080fd5b50610256600480360381019061025191906121b9565b610748565b6040516102639190612172565b60405180910390f35b34801561027857600080fd5b50610293600480360381019061028e9190612244565b610768565b005b3480156102a157600080fd5b506102aa610789565b6040516102b7919061229d565b60405180910390f35b3480156102cc57600080fd5b506102e760048036038101906102e29190612244565b610791565b005b3480156102f557600080fd5b50610310600480360381019061030b91906122e4565b610814565b005b34801561031e57600080fd5b50610327610939565b005b34801561033557600080fd5b50610350600480360381019061034b9190612337565b61094b565b005b34801561035e57600080fd5b50610367610a06565b604051610374919061213e565b60405180910390f35b34801561038957600080fd5b506103a4600480360381019061039f9190612443565b610a1d565b005b3480156103b257600080fd5b506103bb610cd7565b005b3480156103c957600080fd5b506103d2610ceb565b005b3480156103e057600080fd5b506103e9610cfd565b6040516103f691906124da565b60405180910390f35b34801561040b57600080fd5b5061042660048036038101906104219190612244565b610d27565b604051610433919061213e565b60405180910390f35b34801561044857600080fd5b50610463600480360381019061045e9190612337565b610d92565b005b34801561047157600080fd5b5061048c60048036038101906104879190612337565b610e6d565b604051610499919061213e565b60405180910390f35b3480156104ae57600080fd5b506104b7610e8d565b6040516104c49190612172565b60405180910390f35b3480156104d957600080fd5b506104f460048036038101906104ef9190612337565b610e94565b005b34801561050257600080fd5b5061051d600480360381019061051891906124f5565b610f69565b005b34801561052b57600080fd5b5061054660048036038101906105419190612689565b61110c565b005b34801561055457600080fd5b5061056f600480360381019061056a91906121b9565b61125a565b60405161057c919061213e565b60405180910390f35b34801561059157600080fd5b506105ac60048036038101906105a79190612244565b61127a565b005b3480156105ba57600080fd5b506105d560048036038101906105d091906126e5565b61129b565b6040516105e29190612721565b60405180910390f35b6106056004803603810190610600919061273c565b6112c2565b005b34801561061357600080fd5b5061062e600480360381019061062991906121b9565b611682565b60405161063b91906124da565b60405180910390f35b34801561065057600080fd5b5061066b60048036038101906106669190612337565b6116b5565b005b34801561067957600080fd5b50610694600480360381019061068f9190612836565b611738565b6040516106a191906124da565b60405180910390f35b60007f7965db0b000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061071d575061071c82611785565b5b9050919050565b7f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad81565b600060026000838152602001908152602001600020600101549050919050565b61077182610748565b61077a816117ef565b6107848383611803565b505050565b600046905090565b6107996118e4565b73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614610806576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016107fd90612928565b60405180910390fd5b61081082826118ec565b5050565b61081c6119ce565b6004600084815260200190815260200160002060009054906101000a900460ff1661087c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161087390612994565b60405180910390fd5b60006006600085815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060008173ffffffffffffffffffffffffffffffffffffffff16630a6d55d8866040518263ffffffff1660e01b81526004016108ef9190612172565b602060405180830381865afa15801561090c573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061093091906129c9565b90505050505050565b6109416119ce565b610949611a4c565b565b6109536119ce565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036109c2576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016109b990612a42565b60405180910390fd5b80600360016101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b6000600360009054906101000a900460ff16905090565b610a477f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad33610d27565b610a86576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a7d90612aae565b60405180910390fd5b610a8e611aaf565b60006006600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060008661ffff1660108767ffffffffffffffff1668ffffffffffffffffff16901b1790506000828686604051602001610b0193929190612b46565b6040516020818303038152906040528051906020012090506000600860008468ffffffffffffffffff1668ffffffffffffffffff1681526020019081526020016000206000838152602001908152602001600020905060036004811115610b6b57610b6a612b70565b5b8160000160009054906101000a900460ff166004811115610b8f57610b8e612b70565b5b03610bcf576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610bc690612c11565b60405180910390fd5b60038160000160006101000a81548160ff02191690836004811115610bf757610bf6612b70565b5b021790555060008490508073ffffffffffffffffffffffffffffffffffffffff166331ed8ea9878a8a6040518463ffffffff1660e01b8152600401610c3e93929190612c6f565b600060405180830381600087803b158015610c5857600080fd5b505af1158015610c6c573d6000803e3d6000fd5b5050505060036004811115610c8457610c83612b70565b5b8967ffffffffffffffff168b61ffff167f30d60fb848be3b1ac6f234f975cc4511adaced9169b02dfabc4dbeaddf475f7d86604051610cc39190612172565b60405180910390a450505050505050505050565b610cdf6119ce565b610ce96000611af9565b565b610cf36119ce565b610cfb611bbf565b565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60006002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b610d9a6119ce565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610e09576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e0090612d13565b60405180910390fd5b610e337f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad82610768565b7fac6fa858e9350a46cec16539926e0fde25b7629f84b5a72bffaae4df888ae86d81604051610e6291906124da565b60405180910390a150565b60076020528060005260406000206000915054906101000a900460ff1681565b6000801b81565b610e9c6119ce565b610ec67f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad82610d27565b610f05576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610efc90612da5565b60405180910390fd5b610f2f7f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad8261127a565b7f80c0b871b97b595b16a7741c1b06fed0c6f6f558639f18ccbce50724325dc40d81604051610f5e91906124da565b60405180910390a150565b610f937f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad33610d27565b610fd2576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610fc990612aae565b60405180910390fd5b60016004600085815260200190815260200160002060006101000a81548160ff021916908315150217905550816006600085815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008290508073ffffffffffffffffffffffffffffffffffffffff1663b8fa373685846040518363ffffffff1660e01b8152600401611090929190612dc5565b600060405180830381600087803b1580156110aa57600080fd5b505af11580156110be573d6000803e3d6000fd5b50505050838273ffffffffffffffffffffffffffffffffffffffff167fe6b5957a9e181d651f1ac05357cc4153c85f952095f5a4da19ab94958b55a5e960405160405180910390a350505050565b6111367f46a1c849f06514b8f85dce9fbc5f138cc03be404ecade75830481b81556769ad33610d27565b611175576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161116c90612aae565b60405180910390fd5b60006006600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060008190508073ffffffffffffffffffffffffffffffffffffffff16630968f264856040518263ffffffff1660e01b81526004016111eb9190612e65565b600060405180830381600087803b15801561120557600080fd5b505af1158015611219573d6000803e3d6000fd5b505050507ff67611512e0a2d90c96fd3f08dca4971bc45fba9dc679eabe839a32abbe58a8e3360405161124c91906124da565b60405180910390a150505050565b60046020528060005260406000206000915054906101000a900460ff1681565b61128382610748565b61128c816117ef565b61129683836118ec565b505050565b60056020528060005260406000206000915054906101000a900467ffffffffffffffff1681565b6112ca611aaf565b6004600086815260200190815260200160002060009054906101000a900460ff1661132a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161132190612ef9565b60405180910390fd5b85421061136c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161136390612f65565b60405180910390fd5b8634146113ae576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016113a590612fd1565b60405180910390fd5b600360019054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166113f2888887611738565b73ffffffffffffffffffffffffffffffffffffffff1614611448576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161143f90613063565b60405180910390fd5b6000600560008a61ffff1661ffff168152602001908152602001600020600081819054906101000a900467ffffffffffffffff16611485906130b2565b91906101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790559050600073ffffffffffffffffffffffffffffffffffffffff166006600088815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff160361154e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161154590613154565b60405180910390fd5b60006006600088815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060008173ffffffffffffffffffffffffffffffffffffffff16636186e1c4898d868d6115b06118e4565b8c8c8c6040518963ffffffff1660e01b81526004016115d6989796959493929190613183565b6000604051808303816000875af11580156115f5573d6000803e3d6000fd5b505050506040513d6000823e3d601f19601f8201168201806040525081019061161e9190613272565b90508267ffffffffffffffff16888c61ffff167f85ebdc976584c0d4798841a76925cdd5c9e6238521195a96255f6715eee978ab61165a6118e4565b89898760405161166d94939291906132bb565b60405180910390a45050505050505050505050565b60066020528060005260406000206000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6116bd6119ce565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff160361172c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161172390613374565b60405180910390fd5b61173581611af9565b50565b6000806040518060400160405280868152602001858152509050600080600061176086611c22565b80935081945082955050505061177884848484611c65565b9450505050509392505050565b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b611800816117fb6118e4565b611cf7565b50565b61180d8282610d27565b6118e05760016002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506118856118e4565b73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16837f2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d60405160405180910390a45b5050565b600033905090565b6118f68282610d27565b156119ca5760006002600084815260200190815260200160002060000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555061196f6118e4565b73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16837ff6391f5c32d9c69d2a47ea670b442974b53935d1edc7fd64eb21e047a839171b60405160405180910390a45b5050565b6119d66118e4565b73ffffffffffffffffffffffffffffffffffffffff166119f4610cfd565b73ffffffffffffffffffffffffffffffffffffffff1614611a4a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611a41906133e0565b60405180910390fd5b565b611a54611d7c565b6000600360006101000a81548160ff0219169083151502179055507f5db9ee0a495bf2e6ff9c91a7834c1ba4fdd244a5e8aa4e537bd38aeae4b073aa611a986118e4565b604051611aa591906124da565b60405180910390a1565b611ab7610a06565b15611af7576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611aee9061344c565b60405180910390fd5b565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b611bc7611aaf565b6001600360006101000a81548160ff0219169083151502179055507f62e78cea01bee320cd4e420270b5ea74000d11b0c9f74754ebdbfc544b05a258611c0b6118e4565b604051611c1891906124da565b60405180910390a1565b60008060006041845114611c3557600080fd5b60008060006020870151925060408701519150606087015160001a90508083839550955095505050509193909250565b600080600054611c7487611dc5565b604051602001611c859291906134e4565b60405160208183030381529060405280519060200120905060018186868660405160008152602001604052604051611cc09493929190613537565b6020604051602081039080840390855afa158015611ce2573d6000803e3d6000fd5b50505060206040510351915050949350505050565b611d018282610d27565b611d7857611d0e81611e21565b611d1c8360001c6020611e4e565b604051602001611d2d929190613650565b6040516020818303038152906040526040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611d6f91906136c3565b60405180910390fd5b5050565b611d84610a06565b611dc3576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611dba90613731565b60405180910390fd5b565b60007f2e66d0f9c756c5a709dfbfe011049def740fec7ae112683cd453e5b7300e85bb82600001518360200151604051602001611e0493929190613751565b604051602081830303815290604052805190602001209050919050565b6060611e478273ffffffffffffffffffffffffffffffffffffffff16601460ff16611e4e565b9050919050565b606060006002836002611e619190613788565b611e6b91906137e2565b67ffffffffffffffff811115611e8457611e8361255e565b5b6040519080825280601f01601f191660200182016040528015611eb65781602001600182028036833780820191505090505b5090507f300000000000000000000000000000000000000000000000000000000000000081600081518110611eee57611eed613838565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053507f780000000000000000000000000000000000000000000000000000000000000081600181518110611f5257611f51613838565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535060006001846002611f929190613788565b611f9c91906137e2565b90505b600181111561203c577f3031323334353637383961626364656600000000000000000000000000000000600f861660108110611fde57611fdd613838565b5b1a60f81b828281518110611ff557611ff4613838565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350600485901c94508061203590613867565b9050611f9f565b5060008414612080576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612077906138dc565b60405180910390fd5b8091505092915050565b6000604051905090565b600080fd5b600080fd5b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b6120d38161209e565b81146120de57600080fd5b50565b6000813590506120f0816120ca565b92915050565b60006020828403121561210c5761210b612094565b5b600061211a848285016120e1565b91505092915050565b60008115159050919050565b61213881612123565b82525050565b6000602082019050612153600083018461212f565b92915050565b6000819050919050565b61216c81612159565b82525050565b60006020820190506121876000830184612163565b92915050565b61219681612159565b81146121a157600080fd5b50565b6000813590506121b38161218d565b92915050565b6000602082840312156121cf576121ce612094565b5b60006121dd848285016121a4565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000612211826121e6565b9050919050565b61222181612206565b811461222c57600080fd5b50565b60008135905061223e81612218565b92915050565b6000806040838503121561225b5761225a612094565b5b6000612269858286016121a4565b925050602061227a8582860161222f565b9150509250929050565b6000819050919050565b61229781612284565b82525050565b60006020820190506122b2600083018461228e565b92915050565b6122c181612284565b81146122cc57600080fd5b50565b6000813590506122de816122b8565b92915050565b6000806000606084860312156122fd576122fc612094565b5b600061230b868287016121a4565b935050602061231c868287016122cf565b925050604061232d8682870161222f565b9150509250925092565b60006020828403121561234d5761234c612094565b5b600061235b8482850161222f565b91505092915050565b600061ffff82169050919050565b61237b81612364565b811461238657600080fd5b50565b60008135905061239881612372565b92915050565b600067ffffffffffffffff82169050919050565b6123bb8161239e565b81146123c657600080fd5b50565b6000813590506123d8816123b2565b92915050565b600080fd5b600080fd5b600080fd5b60008083601f840112612403576124026123de565b5b8235905067ffffffffffffffff8111156124205761241f6123e3565b5b60208301915083600182028301111561243c5761243b6123e8565b5b9250929050565b60008060008060006080868803121561245f5761245e612094565b5b600061246d88828901612389565b955050602061247e888289016123c9565b945050604086013567ffffffffffffffff81111561249f5761249e612099565b5b6124ab888289016123ed565b935093505060606124be888289016121a4565b9150509295509295909350565b6124d481612206565b82525050565b60006020820190506124ef60008301846124cb565b92915050565b60008060006060848603121561250e5761250d612094565b5b600061251c868287016121a4565b935050602061252d8682870161222f565b925050604061253e8682870161222f565b9150509250925092565b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6125968261254d565b810181811067ffffffffffffffff821117156125b5576125b461255e565b5b80604052505050565b60006125c861208a565b90506125d4828261258d565b919050565b600067ffffffffffffffff8211156125f4576125f361255e565b5b6125fd8261254d565b9050602081019050919050565b82818337600083830152505050565b600061262c612627846125d9565b6125be565b90508281526020810184848401111561264857612647612548565b5b61265384828561260a565b509392505050565b600082601f8301126126705761266f6123de565b5b8135612680848260208601612619565b91505092915050565b600080604083850312156126a05761269f612094565b5b600083013567ffffffffffffffff8111156126be576126bd612099565b5b6126ca8582860161265b565b92505060206126db858286016121a4565b9150509250929050565b6000602082840312156126fb576126fa612094565b5b600061270984828501612389565b91505092915050565b61271b8161239e565b82525050565b60006020820190506127366000830184612712565b92915050565b60008060008060008060008060e0898b03121561275c5761275b612094565b5b600061276a8b828c016122cf565b985050602061277b8b828c016122cf565b975050604061278c8b828c016122cf565b965050606061279d8b828c016121a4565b955050608089013567ffffffffffffffff8111156127be576127bd612099565b5b6127ca8b828c0161265b565b94505060a089013567ffffffffffffffff8111156127eb576127ea612099565b5b6127f78b828c0161265b565b93505060c089013567ffffffffffffffff81111561281857612817612099565b5b6128248b828c016123ed565b92509250509295985092959890939650565b60008060006060848603121561284f5761284e612094565b5b600061285d868287016122cf565b935050602061286e868287016122cf565b925050604084013567ffffffffffffffff81111561288f5761288e612099565b5b61289b8682870161265b565b9150509250925092565b600082825260208201905092915050565b7f416363657373436f6e74726f6c3a2063616e206f6e6c792072656e6f756e636560008201527f20726f6c657320666f722073656c660000000000000000000000000000000000602082015250565b6000612912602f836128a5565b915061291d826128b6565b604082019050919050565b6000602082019050818103600083015261294181612905565b9050919050565b7f7265736f75726365206e6f742072656769737465726564000000000000000000600082015250565b600061297e6017836128a5565b915061298982612948565b602082019050919050565b600060208201905081810360008301526129ad81612971565b9050919050565b6000815190506129c381612218565b92915050565b6000602082840312156129df576129de612094565b5b60006129ed848285016129b4565b91505092915050565b7f496e76616c69642051756f7465205369676e6572000000000000000000000000600082015250565b6000612a2c6014836128a5565b9150612a37826129f6565b602082019050919050565b60006020820190508181036000830152612a5b81612a1f565b9050919050565b7f425249444745203a20556e617574686f72697a65640000000000000000000000600082015250565b6000612a986015836128a5565b9150612aa382612a62565b602082019050919050565b60006020820190508181036000830152612ac781612a8b565b9050919050565b60008160601b9050919050565b6000612ae682612ace565b9050919050565b6000612af882612adb565b9050919050565b612b10612b0b82612206565b612aed565b82525050565b600081905092915050565b6000612b2d8385612b16565b9350612b3a83858461260a565b82840190509392505050565b6000612b528286612aff565b601482019150612b63828486612b21565b9150819050949350505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b7f425249444745203a2065786563757465427269646765203a20616c726561647960008201527f206465706f736974656400000000000000000000000000000000000000000000602082015250565b6000612bfb602a836128a5565b9150612c0682612b9f565b604082019050919050565b60006020820190508181036000830152612c2a81612bee565b9050919050565b600082825260208201905092915050565b6000612c4e8385612c31565b9350612c5b83858461260a565b612c648361254d565b840190509392505050565b6000604082019050612c846000830186612163565b8181036020830152612c97818486612c42565b9050949350505050565b7f425249444745203a2061646452656c6179203a206e6f2061646472657373207060008201527f726f766964656400000000000000000000000000000000000000000000000000602082015250565b6000612cfd6027836128a5565b9150612d0882612ca1565b604082019050919050565b60006020820190508181036000830152612d2c81612cf0565b9050919050565b7f425249444745203a2072656d6f766552656c6179203a206e6f7420612072656c60008201527f6179000000000000000000000000000000000000000000000000000000000000602082015250565b6000612d8f6022836128a5565b9150612d9a82612d33565b604082019050919050565b60006020820190508181036000830152612dbe81612d82565b9050919050565b6000604082019050612dda6000830185612163565b612de760208301846124cb565b9392505050565b600081519050919050565b60005b83811015612e17578082015181840152602081019050612dfc565b83811115612e26576000848401525b50505050565b6000612e3782612dee565b612e418185612c31565b9350612e51818560208601612df9565b612e5a8161254d565b840191505092915050565b60006020820190508181036000830152612e7f8184612e2c565b905092915050565b7f425249444745203a206465706f736974203a20696e76616c6964207265736f7560008201527f7263650000000000000000000000000000000000000000000000000000000000602082015250565b6000612ee36023836128a5565b9150612eee82612e87565b604082019050919050565b60006020820190508181036000830152612f1281612ed6565b9050919050565b7f425249444745203a206465706f736974203a207061737320646561646c696e65600082015250565b6000612f4f6020836128a5565b9150612f5a82612f19565b602082019050919050565b60006020820190508181036000830152612f7e81612f42565b9050919050565b7f425249444745203a206465706f736974203a20696e76616c696420636f737400600082015250565b6000612fbb601f836128a5565b9150612fc682612f85565b602082019050919050565b60006020820190508181036000830152612fea81612fae565b9050919050565b7f425249444745203a206465706f736974203a20696e76616c69642051756f746560008201527f205369676e657200000000000000000000000000000000000000000000000000602082015250565b600061304d6027836128a5565b915061305882612ff1565b604082019050919050565b6000602082019050818103600083015261307c81613040565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006130bd8261239e565b915067ffffffffffffffff82036130d7576130d6613083565b5b600182019050919050565b7f425249444745203a206465706f736974203a20696e76616c6964207265736f7560008201527f7263652069640000000000000000000000000000000000000000000000000000602082015250565b600061313e6026836128a5565b9150613149826130e2565b604082019050919050565b6000602082019050818103600083015261316d81613131565b9050919050565b61317d81612364565b82525050565b600060e082019050613198600083018b612163565b6131a5602083018a613174565b6131b26040830189612712565b6131bf606083018861228e565b6131cc60808301876124cb565b81810360a08301526131de8186612e2c565b905081810360c08301526131f3818486612c42565b90509998505050505050505050565b6000613215613210846125d9565b6125be565b90508281526020810184848401111561323157613230612548565b5b61323c848285612df9565b509392505050565b600082601f830112613259576132586123de565b5b8151613269848260208601613202565b91505092915050565b60006020828403121561328857613287612094565b5b600082015167ffffffffffffffff8111156132a6576132a5612099565b5b6132b284828501613244565b91505092915050565b60006060820190506132d060008301876124cb565b81810360208301526132e3818587612c42565b905081810360408301526132f78184612e2c565b905095945050505050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160008201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b600061335e6026836128a5565b915061336982613302565b604082019050919050565b6000602082019050818103600083015261338d81613351565b9050919050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572600082015250565b60006133ca6020836128a5565b91506133d582613394565b602082019050919050565b600060208201905081810360008301526133f9816133bd565b9050919050565b7f5061757361626c653a2070617573656400000000000000000000000000000000600082015250565b60006134366010836128a5565b915061344182613400565b602082019050919050565b6000602082019050818103600083015261346581613429565b9050919050565b600081905092915050565b7f1901000000000000000000000000000000000000000000000000000000000000600082015250565b60006134ad60028361346c565b91506134b882613477565b600282019050919050565b6000819050919050565b6134de6134d982612159565b6134c3565b82525050565b60006134ef826134a0565b91506134fb82856134cd565b60208201915061350b82846134cd565b6020820191508190509392505050565b600060ff82169050919050565b6135318161351b565b82525050565b600060808201905061354c6000830187612163565b6135596020830186613528565b6135666040830185612163565b6135736060830184612163565b95945050505050565b7f416363657373436f6e74726f6c3a206163636f756e7420000000000000000000600082015250565b60006135b260178361346c565b91506135bd8261357c565b601782019050919050565b600081519050919050565b60006135de826135c8565b6135e8818561346c565b93506135f8818560208601612df9565b80840191505092915050565b7f206973206d697373696e6720726f6c6520000000000000000000000000000000600082015250565b600061363a60118361346c565b915061364582613604565b601182019050919050565b600061365b826135a5565b915061366782856135d3565b91506136728261362d565b915061367e82846135d3565b91508190509392505050565b6000613695826135c8565b61369f81856128a5565b93506136af818560208601612df9565b6136b88161254d565b840191505092915050565b600060208201905081810360008301526136dd818461368a565b905092915050565b7f5061757361626c653a206e6f7420706175736564000000000000000000000000600082015250565b600061371b6014836128a5565b9150613726826136e5565b602082019050919050565b6000602082019050818103600083015261374a8161370e565b9050919050565b60006060820190506137666000830186612163565b613773602083018561228e565b613780604083018461228e565b949350505050565b600061379382612284565b915061379e83612284565b9250817fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff04831182151516156137d7576137d6613083565b5b828202905092915050565b60006137ed82612284565b91506137f883612284565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0382111561382d5761382c613083565b5b828201905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b600061387282612284565b91506000820361388557613884613083565b5b600182039050919050565b7f537472696e67733a20686578206c656e67746820696e73756666696369656e74600082015250565b60006138c66020836128a5565b91506138d182613890565b602082019050919050565b600060208201905081810360008301526138f5816138b9565b905091905056fea2646970667358221220d33f30ebba1e6e1455b3ef004c389c602cfc7dcc1985274a7211ff529a5470ce64736f6c634300080f00330000000000000000000000005e2157a078d15821dafb0d53aa8b08cbd31bdd65").unwrap();
		let v = 403643;
		let r = H256::from_str
			("0x984c457a98af24965852aabf4b18ac93dc475edfb85a3c65d36ec21755a552bf").unwrap();
		let s = H256::from_str
			("0x1997ddc6db499f3dfe59d1df9a82cef6f5accb9088120aa6253ef13894aef287").unwrap();

		let non_authority = H160::from_str(NON_AUTHORITY_ADDR).unwrap();

		assert_noop!(EvmTxReplay::replay_tx(
			RuntimeOrigin::signed(non_authority),
			0,
			from,
			nonce.into(),
			gas_price.into(),
			gas_limit.into(),
			None,
			value.into(),
			data,
			v,
			r,
			s),
			sp_runtime::DispatchError::BadOrigin
		);

		let expected_contract_address = H160::from_str("a18D092eeCC276514B573cB4Fe86620Cc7A62A16").unwrap();
		let empty_vec: Vec<u8> = Vec::new();

		assert_eq!(pallet_evm::AccountCodes::<Test>::get(expected_contract_address), empty_vec);
	});
}
